<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Razorpay Integration</title>
</head>
<body>
  <h1>Pay with Razorpay</h1>
  <button id="payBtn">Pay Now</button>

  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
  <script>
    document.getElementById("payBtn").onclick = async function () {
      const order = await fetch("http://127.0.0.1:7023/user/create", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ amount: 100 })
      }).then(res => res.json());

      var options = {
        "key": "<%= key_id %>",   
        "amount": order.amount,
        "currency": "INR",
        "name": "My Shop",
        "description": "Test Transaction",
        "order_id": order.id,
        "handler": async function (response) {
          const verify = await fetch("http://127.0.0.1:7023/user/verify", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(response)
          }).then(res => res.json());

          alert(verify.message);
        },
        "theme": { "color": "#3399cc" },
        "method": { upi: true, card: true, netbanking: true, wallet: true }
      };

      var rzp1 = new Razorpay(options);
      rzp1.open();
    }
  </script>
</body>
</html>
